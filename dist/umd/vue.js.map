{"version":3,"file":"vue.js","sources":["../../src/utils/index.js","../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/compiler/index.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export function isObject(obj) {\n  return typeof obj === 'object' && obj !== null\n}\n\nexport function def(data, key, value) {\n  Object.defineProperty(data, key, {\n    enumerable: false, // 不可遍历\n    configurable: false,\n    value: value,\n  })\n}\n","// 重写数组的方法 push、pop、shift、unshift、sort、splice、reverse(这些方法回改变原数组所以需要重写)，slice这个方法不会改变原数组所以不需要重写\nlet oldArrayMethods = Array.prototype\nexport const arrayMethods = Object.create(oldArrayMethods)\n\nconst methods = ['push', 'pop', 'shift', 'unshift', 'sort', 'splice', 'reverse']\nmethods.forEach(function (method) {\n  arrayMethods[method] = function (...args) {\n    console.log('用户操作了', method)\n    const result = oldArrayMethods[method].apply(this, args) // 这里得把args传过去才行\n    // push unshift方法插入的值可能是对象需要观测\n    let insert\n    let ob = this.__ob__\n    switch (method) {\n      case 'push':\n      case 'unshift':\n        insert = args\n        break\n      case 'splice':\n        insert = args.slice(2)\n      default:\n        break\n    }\n    if (insert) {\n      ob.observerArray(insert)\n    }\n    return result\n  }\n})\n","// Object.defineProperty 不能兼容IE8以下\nimport { isObject, def } from '../utils/index'\nimport { arrayMethods } from './array.js'\nclass Observer {\n  constructor(value) {\n    value.__ob__ = this\n    def(value, '__ob__', this)\n    if (Array.isArray(value)) {\n      // 数组不会对索引进行监控，性能差，前端开发中通过索引去操作也很少，一般用的push、 pop等方法\n      // 重写数组方法\n      value.__proto__ = arrayMethods\n      // 对数组的对象去监控\n      this.observerArray(value)\n    } else {\n      this.walk(value)\n    }\n  }\n  walk(data) {\n    Object.keys(data).forEach((key) => {\n      defineReactive(data, key, data[key])\n    })\n  }\n  observerArray(data) {\n    data.forEach((item) => {\n      observer(item)\n    })\n  }\n}\nfunction defineReactive(data, key, value) {\n  observer(value) // 递归实现深度检测\n  Object.defineProperty(data, key, {\n    get() {\n      return value\n    },\n    set(newValue) {\n      observer(newValue) // 新值也是对象的时候需要再次监测\n      if (value !== newValue) {\n        value = newValue\n      }\n    },\n  })\n}\nexport function observer(data) {\n  if (!isObject(data)) {\n    return\n  }\n  return new Observer(data)\n}\n","import { observer } from './observer/index';\nexport function initState(vm) {\n  // vue 的props、methods、data、computed、watch、等的初始化\n  const opts = vm.$options\n  if (opts.props) {\n    initProps(vm)\n  }\n  if (opts.methods) {\n    initMethod(vm)\n  }\n  if (opts.data) {\n    initData(vm)\n  }\n  if (opts.computed) {\n    initComputed(vm)\n  }\n  if (opts.watch) {\n    initWatch(vm)\n  }\n}\nfunction initProps(vm) {}\nfunction initMethod(vm) {}\nfunction initData(vm) {\n  console.log('初始化数据', vm)\n  let data = vm.$options.data\n  data = vm._data = typeof data === 'function' ? data.call(vm) : data\n  // 对象劫持\n  // Object.defineProperty,给书香增加get、set 方法\n  observer(data) // 响应式原理\n}\nfunction initComputed(vm) {}\nfunction initWatch(vm) {}\n","export const unicodeRegExp =\n  /a-zA-Z\\u00B7\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u203F-\\u2040\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD/\n\n// Regular Expressions for parsing tags and attributes\nconst attribute =\n  /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\nconst dynamicArgAttribute =\n  /^\\s*((?:v-[\\w-]+:|@|:|#)\\[[^=]+?\\][^\\s\"'<>\\/=]*)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z${unicodeRegExp.source}]*`\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`\nconst startTagOpen = new RegExp(`^<${qnameCapture}`) // 标签开头的正则，捕获的内容是标签名\nconst startTagClose = /^\\s*(\\/?)>/ // 捕获的内容是结尾标签\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`)\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g // 匹配{{}}\nconst regexEscapeRE = /[-.*+?^${}()|[\\]\\/\\\\]/g\nconst doctype = /^<!DOCTYPE [^>]+>/i\n// #7298: escape - to avoid being passed as HTML comment when inlined in page\nconst comment = /^<!\\--/\nconst conditionalComment = /^<!\\[/\nexport function compileToRender() {\n  return function render() {}\n}\n","import { initState } from './state.js'\nimport { compileToRender } from './compiler/index.js'\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this\n    vm.$options = options || {}\n    // 初始化状态\n    initState(vm)\n    if (vm.$options.el) {\n      vm.$mount(vm.$options.el)\n    }\n  }\n  Vue.prototype.$mount = function (el) {\n    const vm = this\n    const options = vm.$options\n    vm.$el = document.querySelector(el)\n    const render = options.render\n    if (!render) {\n      let template = vm.template\n      if (!template && vm.$el) {\n        template = vm.$el.outerHTML\n        const render = compileToRender()\n        options.render = render\n      }\n    } else {\n    }\n  }\n}\n","import { initMixin } from './init.js'\nfunction Vue(options) {\n  this._init(options)\n}\ninitMixin(Vue)\nexport default Vue\n"],"names":["isObject","obj","_typeof","def","data","key","value","Object","defineProperty","enumerable","configurable","oldArrayMethods","Array","prototype","arrayMethods","create","methods","forEach","method","console","log","_len","arguments","length","args","_key","result","apply","insert","ob","__ob__","slice","observerArray","Observer","_classCallCheck","isArray","__proto__","walk","_createClass","keys","defineReactive","item","observer","get","set","newValue","initState","vm","opts","$options","props","initData","computed","watch","_data","call","compileToRender","render","initMixin","Vue","_init","options","el","$mount","$el","document","querySelector","template","outerHTML"],"mappings":"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"}